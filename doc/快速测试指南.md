# 🧪 快速测试指南

## ⚡ 5 分钟快速上手

### 准备工作

在你开始测试之前，需要启动两个服务：

#### 1️⃣ 启动后端服务

**使用 IntelliJ IDEA (推荐):**
1. 打开 IntelliJ IDEA
2. File → Open → 选择 `novatech-backend` 文件夹
3. 等待 Maven 下载依赖（第一次可能需要几分钟）
4. 找到文件 `src/main/java/com/novatech/blog/BlogApplication.java`
5. 右键点击 → Run 'BlogApplication'
6. 等待看到日志：
   ```
   ✅ Default admin user created: username='admin', password='admin123'
   ✅ Sample posts created
   Started BlogApplication in X.XXX seconds
   ```

**使用命令行 (需要安装 Maven):**
```bash
cd d:\IT\code\blog\novatech-backend
mvn spring-boot:run
```

**验证后端成功启动：**
- 访问 http://localhost:8080/api/posts
- 应该看到 JSON 格式的文章列表

#### 2️⃣ 启动前端应用

```bash
cd d:\IT\code\blog\novatech-blog
npm run dev
```

看到类似信息表示成功：
```
  ➜  Local:   http://localhost:5173/
```

---

## 🧪 测试场景

### 场景 1️⃣: 查看首页文章列表 (无需登录)

**操作步骤：**
1. 打开浏览器访问 http://localhost:5173
2. 应该看到 Hero 组件和文章卡片网格

**预期结果：**
- ✅ 看到 2 篇示例文章：
  - "Architecting the Future: Why I Built NovaTech"
  - "Understanding React Server Components"
- ✅ 文章卡片显示标题、摘要、分类、标签、阅读时间

**排查：**
- 打开浏览器 DevTools (F12) → Network 标签
- 找到 `posts` 请求，应该返回 200 状态码和 JSON 数据
- 如果显示 Failed，检查后端是否运行

---

### 场景 2️⃣: 查看文章详情 (无需登录)

**操作步骤：**
1. 在首页点击任意文章卡片
2. 应该进入文章详情页

**预期结果：**
- ✅ URL 变为 `http://localhost:5173/post/文章-slug`
- ✅ 显示完整的文章内容（包括 HTML 格式化的内容）
- ✅ 显示文章元数据（日期、阅读时间、分类、标签）

**排查：**
- Network 标签中应该有 `/api/posts/slug` 的 GET 请求
- 响应应该包含 `content` 字段（HTML 内容）

---

### 场景 3️⃣: 管理员登录

**操作步骤：**
1. 点击页面右上角的导航栏中的 "Admin" 或找到登录链接
2. 进入登录页面 (`/admin/login`)

**输入凭证：**
- 用户名: `admin`
- 密码: `admin123`

**点击 "Authenticate" 按钮**

**预期结果：**
- ✅ 登录成功，跳转到编辑器页面 (`/admin/editor`)
- ✅ 页面右上角显示登出按钮或 admin 标识
- ✅ localStorage 中存储了 JWT Token (`novatech_auth_token`)

**排查：**
- Network 标签中应该有 POST `/api/auth/login` 请求
- 响应应该返回 200 和包含 `token` 字段的 JSON
- 如果返回 401，检查用户名和密码是否正确

---

### 场景 4️⃣: 创建新文章

**操作步骤 (必须先登录)：**

1. 点击登录，使用上面的凭证登录
2. 成功后应该进入编辑器页面
3. 填写文章表单：

**示例数据：**
```
标题: "我的 Spring Boot 项目总结"
摘要: "今天总结了 Spring Boot 的核心概念"
分类: Backend
标签: Java, Spring Boot, Backend
阅读时间: 5 min
内容: 
<h2>引言</h2>
<p>Spring Boot 是一个强大的框架...</p>
<h3>核心特性</h3>
<ul>
<li>自动配置</li>
<li>约定大于配置</li>
</ul>
```

4. 点击 "Publish" 按钮

**预期结果：**
- ✅ 按钮显示 "Publishing..." 加载状态
- ✅ 成功后跳转回首页
- ✅ 首页文章列表最上面显示新创建的文章
- ✅ 新文章 slug 自动生成为 "我的-spring-boot-项目总结"

**排查：**
- Network 标签中应该有 POST `/api/posts` 请求
- 请求头中应该包含 `Authorization: Bearer <token>`
- 响应应该返回 201 (Created) 和新文章的完整信息

**如果失败：**
- 检查是否成功登录（Token 是否存在）
- 检查是否填写了必填字段（标题和内容）

---

### 场景 5️⃣: 查看新创建的文章

**操作步骤：**
1. 在首页刷新页面
2. 应该看到新创建的文章在列表最上面
3. 点击新文章进入详情页

**预期结果：**
- ✅ 文章详情页显示你刚才填写的内容
- ✅ HTML 内容正确渲染

---

### 场景 6️⃣: 登出

**操作步骤：**
1. 点击页面导航栏中的"Logout"按钮
2. localStorage 中的 Token 被清除
3. 跳转回首页

**预期结果：**
- ✅ 导航栏不再显示 admin 标识
- ✅ 无法访问 `/admin/editor` (会重定向)

---

## 📊 API 测试 (使用 PowerShell)

### 测试 1: 获取所有文章
```powershell
$response = Invoke-RestMethod -Uri "http://localhost:8080/api/posts" -Method Get
$response | ConvertTo-Json
```

**预期响应：**
```json
[
  {
    "id": 1,
    "slug": "welcome-to-novatech",
    "title": "Architecting the Future: Why I Built NovaTech",
    "excerpt": "A deep dive into the tech stack...",
    "category": "Frontend",
    "readTime": "5 min",
    "date": "2023-10-27",
    "tags": ["React", "Architecture", "Design"],
    "content": "<div class=\"space-y-6\">..."
  },
  ...
]
```

### 测试 2: 登录获取 Token
```powershell
$body = @{
    username = "admin"
    password = "admin123"
} | ConvertTo-Json

$response = Invoke-RestMethod -Uri "http://localhost:8080/api/auth/login" `
    -Method Post `
    -ContentType "application/json" `
    -Body $body

$token = $response.token
Write-Host "Token: $token"
```

**预期响应：**
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "username": "admin",
  "role": "ADMIN"
}
```

### 测试 3: 使用 Token 创建文章
```powershell
$token = "your_jwt_token_here"
$body = @{
    title = "测试文章"
    excerpt = "这是一篇测试文章"
    content = "<p>这是文章内容</p>"
    category = "Backend"
    tags = @("Java", "Test")
    readTime = "3 min"
} | ConvertTo-Json

$headers = @{
    "Authorization" = "Bearer $token"
    "Content-Type" = "application/json"
}

$response = Invoke-RestMethod -Uri "http://localhost:8080/api/posts" `
    -Method Post `
    -Headers $headers `
    -Body $body

$response | ConvertTo-Json
```

**预期响应：**
```json
{
  "id": 3,
  "slug": "测试文章",
  "title": "测试文章",
  "excerpt": "这是一篇测试文章",
  "content": "<p>这是文章内容</p>",
  "category": "Backend",
  "readTime": "3 min",
  "createdAt": "2025-11-28T10:30:00",
  "date": "2025-11-28",
  "tags": ["Java", "Test"]
}
```

---

## 🔍 浏览器开发者工具使用

### 检查 Network 请求

1. 打开 DevTools (F12)
2. 切换到 "Network" 标签
3. 刷新页面 (F5)
4. 查看网络请求列表

**应该看到的请求：**
- `GET /api/posts` - 获取文章列表
- `GET /api/posts/slug-name` - 获取文章详情
- `POST /api/auth/login` - 登录请求
- `POST /api/posts` - 创建文章

### 检查 LocalStorage

1. 打开 DevTools (F12)
2. 切换到 "Application" 标签
3. 左侧选择 "Local Storage"
4. 选择 "http://localhost:5173"

**应该看到的数据：**
- `novatech_auth_token`: JWT Token (登录后)

### 查看 Console 日志

1. 打开 DevTools (F12)
2. 切换到 "Console" 标签
3. 查看是否有错误信息 (红色)

---

## 📋 测试检查清单

使用以下清单确保所有功能正常工作：

- [ ] 后端成功启动 (看到初始化日志)
- [ ] 前端成功启动 (可访问 localhost:5173)
- [ ] 首页加载文章列表
- [ ] 可以点击文章查看详情
- [ ] 可以进入登录页面
- [ ] 可以成功登录 (admin/admin123)
- [ ] 登录后可以进入编辑器页面
- [ ] 可以创建新文章
- [ ] 新文章出现在首页
- [ ] 可以查看新创建的文章
- [ ] 可以登出
- [ ] Network 请求正常 (无 CORS 错误)
- [ ] Console 没有红色错误

---

## 🎯 快速故障排查

### 问题: 首页加载失败 / 显示空白
**可能原因：**
1. 后端服务未启动
2. 后端服务启动在不同端口

**解决：**
1. 检查后端是否运行: 访问 http://localhost:8080/api/posts
2. 检查浏览器 Console 是否有错误
3. 重启后端服务

### 问题: 登录失败，显示 "Invalid username or password"
**可能原因：**
1. 用户名或密码错误
2. 后端服务故障

**解决：**
1. 确认使用 `admin` / `admin123`
2. 使用 PowerShell 直接测试 API
3. 查看后端日志

### 问题: 创建文章失败
**可能原因：**
1. 未登录或 Token 过期
2. 必填字段为空
3. 后端服务异常

**解决：**
1. 重新登录
2. 检查是否填写了标题和内容
3. 查看浏览器 Network 标签中的请求/响应
4. 查看后端日志

### 问题: CORS 错误
**错误信息：** Access to XMLHttpRequest at 'localhost:8080' from origin 'localhost:5173' has been blocked

**原因：** 跨域请求被阻止

**解决：**
1. 检查后端 CORS 配置是否包含 `http://localhost:5173`
2. 确保请求头中包含 `Content-Type: application/json`
3. 重启后端服务

---

## ✅ 完成标志

当你能够：
1. ✅ 查看首页文章列表
2. ✅ 登录成功
3. ✅ 创建新文章
4. ✅ 查看新创建的文章

**恭喜！前后端对接已完成！** 🎉

---

**需要帮助？** 查看 `前后端对接总结.md` 了解更多细节。
